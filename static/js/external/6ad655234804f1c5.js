;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="445ef67c-7462-2eb3-2e2a-367ef5d3d6a8")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,192479,441648,285030,832970,683743,149797,e=>{"use strict";var r,t,n=e.i(297083),i=e.i(530658),s=e.i(346715),o=e.i(817556),a=e.i(276385),c=e.i(399528),l=e.i(389959),u=e.i(906368),d=e.i(442121),m=e.i(569910),g=e.i(694387),p=e.i(738623),h=e.i(878420),f=e.i(761201),v=e.i(446530),y=e.i(613355),x=e.i(960178),w=e.i(625484),b=(0,v.cssRecord)({signupFormEmailDisclaimerContainer:[y.rcss.width("100%")],signupFormEmailDisclaimer:[y.rcss.color.brandText,y.rcss.font.brandVariable,y.brandStyles.typography.caption.small,y.rcss.textAlign.center,y.rcss.width("100%")],link:[y.rcss.color.foregroundDefault,{fontWeight:700,textDecoration:"none"}]});let j=function(){return(0,a.jsx)(w.View,{css:b.signupFormEmailDisclaimerContainer,children:(0,a.jsxs)(x.Text,{css:b.signupFormEmailDisclaimer,children:["By continuing, you agree to Replit's",(0,a.jsx)("br",{}),(0,a.jsx)("a",{css:b.link,href:f.LINKS_LEGAL.TERMS_OF_SERVICE,target:"_blank",children:"Terms of Service"})," ","and"," ",(0,a.jsx)("a",{css:b.link,href:f.LINKS_LEGAL.PRIVACY_POLICY,target:"_blank",children:"Privacy Policy"})]})})};var C=e.i(252890),S=e.i(480028),I=e.i(988676),k=[y.rcss.align.center,y.rcss.colWithGap(16)],_=(0,v.cssRecord)({footerLinkWrapper:[y.brandStyles.typography.caption.small,y.rcss.textAlign.center],footerLink:[y.brandStyles.typography.caption.small,y.rcss.color.brandAccentStrongest,{":hover":{color:S.tokens.brandAccentStronger,backgroundColor:"transparent"}}],footerContainerNotModal:(0,s._)(k).concat([y.rcss.bottom(24)]),footerContainerModal:(0,s._)(k).concat([y.rcss.pt(24)]),heightWrapper:[y.rcss.height(132)],recaptchaDisclaimer:[y.rcss.textAlign.center,y.brandStyles.typography.caption.small,y.rcss.color.foregroundDimmest,{"& > a":{color:"inherit",textDecoration:"underline"},"& > a:hover":{textDecoration:"none"}}]}),P=function(e){var r=e.mode,t=e.isModal,n=e.onModeChange,i=e.className,s=function(e){e.preventDefault(),(0,C.trackToggleAuth)({isLogin:"login"===r,authFormPlacement:t?"modal":"auth-page"}),n("login"===r?"signup":"login")};return(0,a.jsxs)(x.Text,{css:_.footerLinkWrapper,className:i,variant:"small",multiline:!1,children:["login"===r?"New to Replit? ":"Already have an account? ",(0,a.jsx)("a",{role:"button",tabIndex:0,onKeyDown:function(e){"Enter"===e.key&&s(e)},onClick:function(e){return s(e)},css:_.footerLink,children:"login"===r?"Sign up":"Log in"})]})},T=function(){return(0,a.jsxs)(x.Text,{variant:"small",color:"dimmest",css:_.recaptchaDisclaimer,children:["This site is protected by reCAPTCHA Enterprise and the Google"," ",(0,a.jsx)("a",{href:"https://policies.google.com/privacy",children:"Privacy Policy"})," and"," ",(0,a.jsx)("a",{href:"https://policies.google.com/terms",children:"Terms of Service"})," apply."]})};let E=function(e){var r=e.isModal,t=e.mode,n=e.onModeChange,i=r?void 0:_.heightWrapper;return(0,a.jsx)(w.View,{css:i,children:(0,a.jsxs)(w.View,{css:r?_.footerContainerModal:_.footerContainerNotModal,children:[(0,a.jsx)(I.DividerH,{}),"signup"===t?(0,a.jsx)(w.View,{pb:24,children:(0,a.jsx)(j,{})}):null,(0,a.jsx)(P,{mode:t,isModal:r,onModeChange:n}),(0,a.jsx)(w.View,{row:!0,gap:16,align:"center",children:(0,a.jsx)(x.Text,{css:_.footerLinkWrapper,variant:"small",multiline:!1,children:(0,a.jsx)("a",{href:"https://replit.com/help",target:"_blank",rel:"noopener noreferrer",css:_.footerLink,children:"Get help"})})}),(0,a.jsx)(T,{})]})})};e.s(["AuthTypeToggle",()=>P,"default",0,E],441648);var R=(0,v.cssRecord)({self:[y.rcss.font.brandDefault,{fontWeight:512,fontSize:24,lineHeight:32/24}]});let L=function(e){var r=e.mode,t=e.privateDeployment,n=e.privateDevDomain,i="Create a Replit account";return"login"===r&&(i="Log in to your account"),t&&(i="Log in to access a private website"),n&&(i="Log in to access a private app"),(0,a.jsx)(x.Header,{variant:"headerDefault",level:1,css:R.self,children:i})};var A=e.i(33699),D=e.i(64386),F=e.i(571926),M=e.i(344188),U=e.i(858248),V=function(e){if(e.isLoggedIn){var r;(0,U.identify)((0,D._)((0,h._)({id:e.id.toString(),email:e.email,roles:e.roles,verified:e.isVerified,emailPreference:e.emailNotifications,createdAt:e.timeCreated},!!e.loginMethod&&{loginMethod:e.loginMethod}),{signupMethod:null!=(r=e.signupMethod)?r:F.NONE_IDENTIFY_PROP}))}},W=e.i(414248),O=e.i(700005);function B(e){var r=e.redirectUrl,t=O.default.get("shouldUseMobileAppAuthComplete");return"string"!=typeof t||t.length<1?r:"/authComplete?redirectUrl=".concat(encodeURI(r))}var N=e.i(294426),G=e.i(501005),H=e.i(441329),z=e.i(709485),K=e.i(612372),Y=e.i(61667),Q=e.i(887877),q=e.i(616278),J=e.i(940745),X=(0,v.cssRecord)({form:[y.rcss.colWithGap(8),y.rcss.width("100%")],secondaryAction:[y.rcss.width("100%"),y.rcss.textAlign.center,y.brandStyles.typography.caption.medium,y.rcss.color.brandAccentStrongest,{":hover":{color:S.tokens.brandAccentStronger,backgroundColor:"transparent"}}]});function Z(e){var r=e.onSubmit,t=e.trackSource,s=e.footer,d=e.emailField,m=(0,i._)((0,l.useState)(!1),2),g=m[0],f=m[1],v=(0,i._)((0,l.useState)(!1),2),y=v[0],x=v[1],b=(0,i._)((0,l.useState)(""),2),j=b[0],C=b[1],S=(0,c.useRouter)(),I=function(e){var i=e.emailOrUsername,s=e.password;return(0,n._)(function(){var e,n,a,c,l;return(0,o._)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(0,N.getRecaptchaToken)({action:"signInWithPassword"})];case 1:return e=o.sent(),[3,3];case 2:return o.sent(),[2,{fallthrough:!0}];case 3:return[4,(0,p.signInWithPassword)({emailOrUsername:i,rawPassword:s,clientType:"CLIENT_TYPE_WEB",recaptchaToken:e})];case 4:if("error"===(n=o.sent()).type)return x(!1),f(!1),r({error:n.message}),[2,{fallthrough:!1}];return[4,(0,N.setUserFromApiResponse)({response:n.session})];case 5:if("error"===(a=o.sent()).type)return x(!1),f(!1),r({error:a.message}),[2,{fallthrough:!1}];return[4,(0,p.setCookie)(a.user,{source:t})];case 6:return"success"===(c=o.sent()).type?(f(!1),x(!0),l=c.redirectUrl?B({redirectUrl:c.redirectUrl}):void 0,r({user:{id:c.userId,postLoginRedirectUrl:l},isLogin:!0})):(x(!1),f(!1),r({error:c.message,reauth:c.reauth})),[2,{fallthrough:!1}]}})})()};return(0,a.jsxs)(Q.Form,{onSubmit:function(e){return(0,n._)(function(){return(0,o._)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),g)return[2];return f(!0),[4,I({emailOrUsername:d.value,password:j})];case 1:if(!t.sent().fallthrough)return[3,3];return[4,(0,n._)(function(){var e,t,i,s,a;return(0,o._)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,(0,G.default)(void 0,function(){(0,U.track)(z.events.AUTH_FORM_CAPTCHA_TRIGGERED,{authenticationType:"login"})})];case 1:return e=c.sent(),[3,3];case 2:return t=c.sent(),u.captureException(t,function(e){return e.setTag("bonsai",(0,H.isInNativeMobileAuthFlow)(S))}),r({error:"Something went wrong trying to submit. Please try again."}),f(!1),[2];case 3:return[4,function(e){return(0,n._)(function(e){var r,t,n,i,s,a,c,l,u,d;return(0,o._)(this,function(o){switch(o.label){case 0:r=e.username,t=e.password,n=e.teacher,i=e.hCaptchaResponse,s=e.hCaptchaSiteKey,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(0,M.postJson)("/login",(0,D._)((0,h._)({username:r,password:t},n?{teacher:n}:{}),{hCaptchaResponse:i,hCaptchaSiteKey:s}))];case 2:return a=o.sent(),[3,4];case 3:return(null==(u=(d=c=o.sent()).extras)||null==(l=u.responseData)?void 0:l.status)===401&&(c.status=d.extras.responseData.status),[2,{isLoggedIn:!1,error:c}];case 4:return V(a),[2,a]}})}).apply(this,arguments)}({username:d.value,password:j,hCaptchaResponse:e,hCaptchaSiteKey:G.HCAPTCHA_SITE_KEY})];case 4:if("error"in(i=c.sent())){if(s=i.error,f(!1),r({error:s.message||"Something went wrong"}),s.status&&s.status>=500)throw s;return[2]}return a=i.postLoginRedirectUrl?B({redirectUrl:i.postLoginRedirectUrl}):void 0,r({user:{id:i.id,postLoginRedirectUrl:a},isLogin:!0}),[2]}})})()];case 2:t.sent(),t.label=3;case 3:return[2]}})})()},css:X.form,children:[(0,a.jsx)(W.default,{type:"text",label:"Email or username",name:"username",value:d.value,onChange:d.setValue,autoComplete:"email"}),(0,a.jsx)(W.default,{type:"password",label:"Password",name:"password",value:j,onChange:C}),(0,a.jsxs)(w.View,{gap:s?8:24,children:[(0,a.jsx)(K.default,{type:"submit",variant:"primary",stretch:!0,loading:g,disabled:!j||!d.value||y,iconRight:g?(0,a.jsx)(J.default,{}):y?(0,a.jsx)(q.default,{}):void 0,dataCy:"log-in-btn",text:"Log In"}),s||(0,a.jsx)(Y.BrandButtonLink,{variant:"clean",css:X.secondaryAction,href:"/forgot",text:"Forgot password?"}),!1]})]})}e.s(["default",()=>Z],285030);var $=e.i(273325),ee=e.i(322823),er=e.i(978486),et=e.i(664152),en=((r={})[r.Loaded=0]="Loaded",r[r.Skipped=1]="Skipped",r[r.Failed=2]="Failed",r),ei="https://elements.stytch.com/telemetry.js";function es(){return"true"===A.default.env.IS_CYPRESS_AUTOMATED_TEST}var eo=window.location.pathname;function ea(e){return(0,n._)(function(){var r;return(0,o._)(this,function(i){switch(i.label){case 0:var s;return i.trys.push([0,2,,3]),[4,Promise.race([(s=e,(0,n._)(function(){var e,r;return(0,o._)(this,function(i){switch(i.label){case 0:return[4,(0,n._)(function(){return(0,o._)(this,function(e){switch(e.label){case 0:if(es())return[2,1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t];case 2:return e.sent(),[2,0];case 3:return e.sent(),[2,2];case 4:return[2]}})})()];case 1:if(i.sent()!==en.Loaded)return[2];return e=window.location.host.startsWith("staging")?"public-token-test-f16841f0-b961-4442-93b3-751c8cfe0d8b":"public-token-live-88edc789-05cb-440a-a321-dab99f475524",[4,window.GetTelemetryID(e,"https://telemetry.replit.com/submit")];case 2:if(!(r=i.sent())||""===r.trim())return et.logger.error("Client received an empty telemetryId",{userId:s}),[2];return et.logger.info("Successfully received the telemetryId from Stytch ".concat(r),{telemetryId:r,userId:s}),[4,fetch("/telemetry",{method:"GET",headers:{"Content-Type":"application/json","telemetry-id":r,"user-id":s}})];case 3:return i.sent(),[2]}})})()),new Promise(function(e,r){return setTimeout(function(){return r(Error("Could not process device fingerprint in 4s"))},4e3)})])];case 1:return i.sent(),[3,3];case 2:return r=i.sent(),et.logger.error("Error fetching device fingerprint data ".concat(r.message)),[2,"N/A"];case 3:return[2]}})})()}!es()&&["/signup","/login"].some(function(e){return eo.startsWith(e)})&&(0,n._)(function(){var e,r,n;return(0,o._)(this,function(i){return e=performance.now(),(r=document.createElement("script")).src=ei,r.async=!0,n=new Promise(function(e){setTimeout(function(){et.logger.error("Timeout while loading Stytch script"),e()},4e3)}),t=Promise.race([new Promise(function(t){r.onload=function(){var r=performance.now();et.logger.time("time to load Stytch script",r-e),t()},r.onerror=function(){et.logger.error("Error loading Stytch script at ".concat(ei)),t()},document.head.appendChild(r)}),n]),[2]})})().catch(function(e){return u.captureException(e)});var ec=e.i(746788),el=e.i(140487),eu=e.i(127060);function ed(e){return e.error?[{message:e.error.message,state:"error"}]:e.warning?[{message:e.warning.message,state:"warning"}]:e.value?e.isValid?[{message:"",state:"success"}]:e.touched?[{message:"",state:"loading"}]:void 0:void 0}var em=(0,v.cssRecord)({form:[y.rcss.width("100%")]});function eg(e){var r=e.onSubmit,t=e.tracking,s=void 0===t?{from:"explicit"}:t,c=e.emailField,u=(0,i._)((0,l.useState)(!1),2),d=u[0],m=u[1],g=(0,i._)((0,l.useState)(!1),2),h=g[0],f=g[1],v=(0,ee.useFormField)("",ec.default.password),y=(0,er.useGetAgentQueryPrompt)().directQueryPrompt,x=!c.value;return(0,a.jsx)("form",{onSubmit:function(e){return(0,n._)(function(){var t,n,i,a,l;return(0,o._)(this,function(o){switch(o.label){case 0:if(e.preventDefault(),m(!0),c.isValid)return[3,2];return[4,c.validate()];case 1:if(o.sent())return m(!1),[2];o.label=2;case 2:if(!v.isValid&&v.validate())return m(!1),[2];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,(0,N.getRecaptchaToken)({action:"signUpPassword"})];case 4:return t=o.sent(),[3,6];case 5:return o.sent(),r({error:"We failed to evaluate your browser integrity. Please refresh the page and try again. If the problem persists, check your browser and network configuration."}),[2];case 6:return[4,(0,p.signUpWithPassword)({email:c.value,rawPassword:v.value,clientType:"CLIENT_TYPE_WEB",recaptchaToken:t,source:s.from,referrerId:s.referrerId,aiPrompt:y||void 0})];case 7:if("error"===(n=o.sent()).type)return f(!1),m(!1),r({error:n.message}),[2];return[4,(0,N.setUserFromApiResponse)({response:n.session})];case 8:if("error"===(i=o.sent()).type)return f(!1),m(!1),r({error:i.message}),[2];return[4,(0,p.setCookie)(i.user,{source:s.from,referrerId:s.referrerId})];case 9:if("success"===(a=o.sent()).type)return[3,10];return[3,12];case 10:return m(!1),f(!0),[4,ea(a.userId.toString())];case 11:return o.sent(),l=a.redirectUrl?B({redirectUrl:a.redirectUrl}):void 0,(0,eu.sendCoframeConversionEvent)("signup"),r({user:{id:a.userId,postLoginRedirectUrl:l},isLogin:!1}),[3,13];case 12:return f(!1),m(!1),r({error:a.message,reauth:a.reauth}),[3,13];case 13:return[2]}})})()},css:em.form,children:(0,a.jsxs)(w.View,{css:em.form,gap:8,children:[(0,a.jsx)(W.default,{type:"text",name:"email",label:"Email",onBlur:c.handleBlur,validationResults:ed(c),onChange:c.setValue,value:c.value,autoComplete:"email"}),(0,a.jsx)(W.default,{type:"password",label:"Password",name:"password",showToggle:!1,onBlur:v.handleBlur,validationResults:ed(v),onChange:v.setValue,value:v.value}),(0,a.jsx)(w.View,{gap:4,children:(0,a.jsx)(K.default,{type:"submit",variant:"primary",stretch:!0,loading:d,disabled:!v.value||x||h,iconLeft:d?(0,a.jsx)(J.default,{}):h?(0,a.jsx)(q.default,{}):void 0,dataCy:"signup-create-account",text:"Create Account"})}),null]})})}e.s(["default",()=>eg],832970);var ep=e.i(886513),eh=(0,v.cssRecord)({ssoButton:[y.rcss.backgroundColor.brandBackgroundDarker,y.rcss.minHeight(40)],ssoIconWrapper:[y.rcss.borderRadius(4)],ssoIcon:[y.rcss.width(20),y.rcss.height(20),{backgroundSize:"contain"}]}),ef=function(e){var r=e.id;return(0,a.jsx)(w.View,{css:eh.ssoIconWrapper,p:2,children:(0,a.jsx)("div",{style:{backgroundImage:"url(/public/images/".concat(r.replace(".com",""),".png)")},css:eh.ssoIcon})})},ev=function(e){var r=e.onClick,t=e.iconLeft,n=e.text,i=(0,ep._)(e,["onClick","iconLeft","text"]);return(0,a.jsx)(K.default,(0,h._)({css:eh.ssoButton,variant:"secondary",onClick:r,stretch:!0,iconLeft:t,text:n},i))};e.s(["SsoButton",()=>ev,"SsoIcon",()=>ef],683743);var ey=e.i(369948),ex=(0,v.cssRecord)({minimizedSection:[y.rcss.gap(8)],showMoreButton:[y.rcss.py(6)]}),ew=[g.GoogleProviderId,g.GitHubProviderId,g.XProviderId],eb=(0,s._)(ew).concat([g.FacebookProviderId,g.AppleProviderId]);function ej(e){var r=e.mode,t=e.onRedirectingChange,c=e.onSubmit,u=e.onEmailClick,d=e.replitAuthProps,m=(0,i._)((0,l.useState)(!1),2),p=m[0],h=m[1],f=(0,l.useMemo)(function(){var e;return null!=(e=null==d?void 0:d.minimizedProviders)?e:[]},[d]),v=f.includes("email")&&u&&p,y=f.includes("email"),x="login"===r?eb:ew,b=(0,l.useMemo)(function(){var e=function(e){return!!d&&"facebook.com"===e},r=x.filter(function(r){return f.includes(r.replace(".com",""))&&!e(r)}),t=x.filter(function(t){return!r.includes(t)&&!e(t)});return 0===t.length&&r.length>0&&(t.push.apply(t,(0,s._)(r)),r.length=0),{primaryProviders:t,minimizedProvidersList:r}},[x,f,d]),j=b.primaryProviders,C=b.minimizedProvidersList;return(0,a.jsxs)(a.Fragment,{children:[(0,s._)(j).concat((0,s._)(p?C:[])).map(function(e){return(0,a.jsx)(ev,{text:"Continue with ".concat((0,g.getOAuthProviderName)(e)),iconLeft:(0,a.jsx)(ef,{id:e}),onClick:function(){if("facebook.com"===e){window.confirm('Facebook login is no longer supported. Click "Ok" to continue to password reset using the connected email address.')&&(window.location.href="/forgot");return}(0,n._)(function(){var n;return(0,o._)(this,function(i){switch(i.label){case 0:return n=e.replace(".com",""),(0,U.track)(z.events.AUTH_FORM_SSO_REQUESTED,{provider:n,authenticationType:r,isTeacher:"false"}),[4,t(!0)];case 1:return i.sent(),[4,(0,N.signInWithProvider)({tenantId:void 0,provider:{type:"oauth",providerId:e}})];case 2:return"error"===i.sent().type&&c({error:N.signInWithProviderErrorMessage}),[2]}})})()}},e)}),(C.length>0||y)&&!p&&(0,a.jsx)(w.View,{css:ex.minimizedSection,children:(0,a.jsx)(el.Button,{onClick:function(){return h(!0)},css:ex.showMoreButton,variant:"underlined",colorway:"grey",stretch:!0,text:"Other log in methods"})}),v&&(0,a.jsx)(el.Button,{onClick:u,variant:"nofill",iconRight:(0,a.jsx)(ey.default,{}),text:"Continue with email"})]})}e.s(["SsoOptionsList",()=>ej],149797);var eC=e.i(216373),eS=e.i(355744),eI=e.i(245150),ek=(0,v.cssRecord)({mainControls:[y.rcss.width("100%"),y.rcss.px(12)],ssoContainer:[y.rcss.width("100%"),y.rcss.colWithGap(8)],samlLoginForm:[y.rcss.width("100%"),y.rcss.pb(32)],orText:[y.rcss.fontSize(S.tokens.fontSizeSmall)]});function e_(e){var r=e.mode,t=e.onRedirectingChange,n=e.onModeChange,i=e.onSubmit,s=e.tracking,o=e.seededEmail,c=e.isModal;return(0,a.jsxs)(a.Fragment,{children:["login"===r?(0,a.jsx)(eP,{onRedirectingChange:t,onSubmit:i,tracking:s}):(0,a.jsx)(eT,{onRedirectingChange:t,onSubmit:i,seededEmail:o,tracking:s}),(0,a.jsx)(E,{mode:r,isModal:c,onModeChange:n})]})}var eP=function(e){var r=e.onRedirectingChange,t=e.onSubmit,n=e.tracking,s=e.replitAuthProps,o=(0,i._)((0,l.useState)("password"),2),c=o[0],u=o[1],d=(0,ee.useFormField)("",ec.default.isValidEmail);return(0,a.jsxs)(a.Fragment,{children:["password"===c?(0,a.jsx)(Z,{onSubmit:t,trackSource:n.from,emailField:d}):null,"saml"===c?(0,a.jsx)(w.View,{css:ek.samlLoginForm,children:(0,a.jsx)($.default,{onSubmit:t,mode:"login",onRedirectingChange:r,seededEmail:d.value})}):null,(0,a.jsxs)(w.View,{css:ek.ssoContainer,children:[(0,a.jsx)(eE,{emailLoginType:c,setEmailLoginType:u}),(0,a.jsx)(ej,{mode:"login",onRedirectingChange:r,onSubmit:t,replitAuthProps:s})]})]})},eT=function(e){var r=e.onRedirectingChange,t=e.onSubmit,n=e.seededEmail,s=e.tracking,o=(0,i._)((0,l.useState)("initial"),2),c=o[0],u=o[1],d=(0,ee.useFormField)(n||"",ec.default.email);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(w.View,{css:ek.ssoContainer,align:"center",children:[(0,a.jsx)(ej,{mode:"signup",onRedirectingChange:r,onSubmit:t}),"initial"===c?(0,a.jsx)(x.Text,{css:ek.orText,children:"Or"}):(0,a.jsx)(I.DividerH,{}),(0,a.jsx)(eE,{emailLoginType:c,setEmailLoginType:u})]}),"password"===c?(0,a.jsx)(eg,{onSubmit:t,seededEmail:n,tracking:s,emailField:d}):null,"saml"===c?(0,a.jsx)($.default,{onSubmit:t,mode:"signup",onRedirectingChange:r,seededEmail:d.value}):null]})},eE=function(e){var r=e.emailLoginType,t=e.setEmailLoginType;return"password"===r?(0,a.jsx)(ev,{onClick:function(){return t("saml")},iconLeft:(0,a.jsx)(eC.default,{size:20}),text:"Use SSO login"}):"saml"===r?(0,a.jsx)(ev,{onClick:function(){return t("password")},iconLeft:(0,a.jsx)(eI.default,{size:20}),text:"Use email login"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(K.default,{dataCy:"auth-form-reveal-email",onClick:function(){return t("password")},iconLeft:(0,a.jsx)(eS.default,{size:20}),text:"Email & password",variant:"tertiary",stretch:!0}),(0,a.jsx)(K.default,{onClick:function(){return t("saml")},iconLeft:(0,a.jsx)(eC.default,{size:20}),text:"Single sign-on (SSO)",variant:"tertiary",stretch:!0})]})};let eR=function(e){var r=e.children,t=e.customHeader,n=e.isModal,i=e.mode,s=e.onRedirectingChange,o=e.onSubmit,c=e.initialTenantId,u=e.tracking,d=e.privateDeployment,m=e.privateDevDomain,g=e.renderForm;return(0,l.useEffect)(function(){var e,r,t=n?"modal":"auth-page";"login"===i?(0,C.trackLoginView)({from:u.from,location:null!=(e=u.location)?e:"",authFormPlacement:t}):(0,C.trackSignupView)({from:u.from,location:null!=(r=u.location)?r:"",authFormPlacement:t})},[i,n,u.from,u.location]),(0,l.useEffect)(function(){void 0!==c&&(s(!0),(0,p.getAuthTenant)({type:"tenantId",tenantId:c}).then(function(e){"error"===e.type?o({error:e.message}):(0,N.signInWithProvider)({tenantId:e.tenantId,provider:{type:"saml",providerId:e.samlProviderId}}).then(function(e){if("error"===e.type)return void o({error:N.signInWithProviderErrorMessage})})}))},[c,s,o]),(0,a.jsxs)(a.Fragment,{children:[t?null:(0,a.jsx)(L,{mode:i,privateDeployment:d,privateDevDomain:m}),(0,a.jsxs)(w.View,{css:ek.mainControls,gap:12,children:[r,g?g(e):(0,a.jsx)(e_,(0,h._)({},e))]})]})};var eL=e.i(721281),eA=(0,v.cssRecord)({container:[(0,eL._)({margin:"auto"},y.media.max("mobileMax"),[y.rcss.pt(96)]),y.rcss.colWithGap(32)],button:[y.rcss.color.foregroundDimmest]});let eD=function(e){var r=e.email,t=e.providerId,n=e.onCancel,i=(0,g.getOAuthProviderName)(t);return i||(i="this provider",t===g.PasswordProviderId&&(i="your password")),(0,a.jsxs)(w.View,{css:eA.container,pt:128,children:[(0,a.jsx)(x.Header,{variant:"headerDefault",level:1,children:"Verification required"}),(0,a.jsxs)(w.View,{gap:16,children:[(0,a.jsxs)(x.Text,{variant:"subheadDefault",multiline:!0,children:["In order to log in with ",i,", you must verify"," ",r||"your email","."]}),(0,a.jsx)(x.Text,{multiline:!0,children:"We've sent an email with a verification link. If you don't see it, check your spam folder, or contact support for assistance."})]}),(0,a.jsx)(el.Button,{size:"big",variant:"outlined",css:eA.button,onClick:function(){return n()},text:"Back to log in"})]})};var eF=e.i(68278),eM=e.i(956111),eU=e.i(624782),eV=e.i(396776),eW=[y.rcss.width(470),y.rcss.maxWidth("100%"),y.rcss.colWithGap(32),y.rcss.align.center,{margin:"auto","& *":[y.brandFontDefault]}],eO=(0,v.cssRecord)({error:[y.rcss.mb(16)],container:(0,s._)(eW).concat([y.rcss.p(24)]),containerModal:(0,s._)(eW),loadingText:[y.rcss.fontSize(16),y.rcss.flex.shrink(1)]}),eB="redirecting";function eN(e){var r=e.customHeader,t=e.isModal,s=e.mode,h=e.onModeChange,f=e.onSuccess,v=e.seededEmail,y=e.initialTenantId,b=e.tracking,j=e.privateDeployment,S=e.privateDevDomain,I=e.renderForm,k=e.replitAuthProps,_=e.signupCoupon,P=(0,d.useApolloClient)(),T=(0,c.useRouter)(),E=(0,eM.useQueryParam)(eB,"boolean"),R=(0,i._)((0,l.useState)(E?{type:"redirecting"}:{type:"form"}),2),A=R[0],D=R[1],F=(0,i._)((0,l.useState)(),2),M=F[0],U=F[1],V=(0,l.useCallback)(function(e){return(0,n._)(function(){return(0,o._)(this,function(r){switch(r.label){case 0:if(!e)return[3,2];return D({type:"redirecting"}),[4,(0,eM.updatePathWithQueryParams)({router:T,params:[{mode:"add",key:eB,value:"1"}]})];case 1:return r.sent(),[3,3];case 2:D({type:"form"}),(0,eM.updatePathWithQueryParams)({router:T,params:[{mode:"delete",key:eB}]}),r.label=3;case 3:return[2]}})})()},[T]),W=function(e){D({type:"redirecting",message:"SAML SSO required. Redirecting to the SSO login page..."}),setTimeout(function(){return(0,n._)(function(){return(0,o._)(this,function(r){switch(r.label){case 0:return[4,(0,N.signInWithProvider)({tenantId:e.tenantId,provider:{type:"saml",providerId:e.samlProviderId}})];case 1:return"error"===r.sent().type&&(U({message:"Something went wrong. Please try logging in again.",colorway:"negative"}),D({type:"form"})),[2]}})})()},3e3)},O=(0,l.useCallback)(function(e){return(0,n._)(function(){var r,t;return(0,o._)(this,function(n){switch(n.label){case 0:if(!("error"in e&&e.error))return[3,2];if(e.reauth)return W(e.reauth),[2];return U({message:e.error,colorway:null!=(r=e.colorway)?r:"negative"}),[4,V(!1)];case 1:return n.sent(),[2];case 2:if(!("user"in e&&e.user))throw Error("Expected error or user object");if(null!=(t=e.user.postLoginRedirectUrl)&&t.length>0)return window.location.href=t,[2];return e.isLogin||(0,C.attributeAcquisition)(e.user.id.toString()),f(e),[2]}})})()},[V,f,U]),G=(0,eF.useSaveUserAuth)();return(0,l.useEffect)(function(){(0,N.handlePotentialOAuthRedirect)().then(function(e){return(0,n._)(function(){var r,t,n,i;return(0,o._)(this,function(o){switch(o.label){case 0:if("success"!==e.type)return[3,13];if(null===e.result)return"redirecting"===A.type&&V(!1),[2];return"redirecting"!==A.type&&V(!0),[4,(0,p.setCookie)(e.result.user,{source:b.from,referrerId:b.referrerId})];case 1:switch((r=o.sent()).type){case"success":return[3,2];case"needs_email_verification":return[3,7];case"error":return[3,9]}return[3,11];case 2:if((null==(t=e.result)?void 0:t.providerId)!==g.GitHubProviderId)return[3,4];return[4,G({userCredential:e.result,oauthProviderId:g.GitHubProviderId,scopes:[]})];case 3:o.sent(),o.label=4;case 4:if(n=r.redirectUrl?B({redirectUrl:r.redirectUrl}):void 0)return window.location.href=n,[2];if(!(r.isNewUser&&e.result.providerId===g.GoogleProviderId))return[3,6];return[4,ea(r.userId.toString())];case 5:o.sent(),o.label=6;case 6:return f({user:{id:r.userId},isLogin:!r.isNewUser}),[3,12];case 7:return V(!1),D({type:"needs-email-verification",email:e.result.user.email,providerId:e.result.providerId}),[4,(0,N.signOut)(P)];case 8:case 10:return o.sent(),[3,12];case 9:if(r.reauth)return W(r.reauth),[2];return V(!1),U({message:r.message,colorway:"negative"}),[4,(0,N.signOut)(P)];case 11:(0,m.default)(r),o.label=12;case 12:return[2];case 13:switch(V(!1),e.treatment){case"requires-provider-link":return[3,14];case"credential-conflict":return[3,15];case"email-conflict":return[3,16];case"forbidden-operation":return[3,17];case"user-needs-email":return[3,18];case"timeout":case"unhandled":case"unknown":return[3,20]}return[3,21];case 14:return U({message:"Please log in to ".concat(e.context.email," with another method and link ").concat((0,g.getOAuthProviderName)(e.context.credential.providerId)," from the account page."),colorway:"negative"}),[3,22];case 15:return U({message:"This provider cannot be used, please try another method.",colorway:"negative"}),[3,22];case 16:return U({message:"This email cannot be used, please try another method.",colorway:"negative"}),[3,22];case 17:return U({message:"That action is not permitted",colorway:"negative"}),[3,22];case 18:return i=(0,g.getOAuthProviderName)(e.credential.providerId),U({message:"Your ".concat(i," account is missing an email address. To use it for Replit, you'll need to ").concat("login"===s?"log in":"sign up"," with another method and connect ").concat(i," from the account page."),colorway:"negative"}),[4,(0,N.signOut)(P)];case 19:return o.sent(),[3,22];case 20:return U({message:"Something unexpected happened, please try again.",colorway:"negative"}),[3,22];case 21:(0,m.default)(e),o.label=22;case 22:return[2]}})})()}).catch(function(e){return u.captureException(e)})},[]),(0,a.jsx)(w.View,{css:t?eO.containerModal:eO.container,children:"form"===A.type?(0,a.jsxs)(eR,{customHeader:r||!!_,isModal:t,mode:s,onModeChange:function(e){U(void 0),h(e)},onRedirectingChange:V,onSubmit:O,seededEmail:v,initialTenantId:y,tracking:b,privateDeployment:j,privateDevDomain:S,renderForm:I,replitAuthProps:k,children:[M?(0,a.jsx)(eV.StatusBanner,{css:eO.error,colorway:M.colorway,text:M.message}):null,_?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(w.View,{gap:16,align:"center",pb:8,children:[(0,a.jsxs)(w.View,{row:!0,gap:8,align:"center",justify:"center",children:[(0,a.jsx)("div",{children:"Using code"}),(0,a.jsx)(eU.Pill,{colorway:"green",text:_.toUpperCase()})]}),(0,a.jsx)(L,{mode:"signup"})]})}):null]}):"needs-email-verification"===A.type?(0,a.jsx)(eD,{email:A.email,providerId:A.providerId,onCancel:function(){return D({type:"form"})}}):(0,a.jsxs)(w.View,{gap:8,align:"center",children:[(0,a.jsx)(J.default,{size:32}),A.message?(0,a.jsx)(x.Text,{multiline:!0,css:eO.loadingText,children:A.message}):null]})})}e.s(["default",()=>eN,"redirectingParam",()=>eB],192479)}]);

//# debugId=445ef67c-7462-2eb3-2e2a-367ef5d3d6a8
//# sourceMappingURL=f0805774d155c748.js.map