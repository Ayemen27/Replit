/**
 * Workflow Cards Component
 * بطاقات سير العمل
 * 
 * Mobile-First Responsive Cards:
 * - Mobile (≤576px): 1 column, compact spacing
 * - Tablet (577-992px): 2 columns
 * - Desktop (≥993px): 2 columns (auto-fill)
 * 
 * Features:
 * - Touch-optimized swipe actions
 * - Keyboard accessible
 * - Status indicators with colors
 * - RTL support
 * 
 * Compliance:
 * - Material Design 3 §2.2 (Cards)
 * - WCAG 2.1 AA (Touch targets ≥48×48px)
 * - Core Web Vitals: CLS = 0
 * 
 * Version: 1.0.0
 * Last Updated: 2025-11-16
 */

@import '../variables';
@import '../mixins';

/* ============================================
   Workflows Grid Container
   ============================================ */

.workflows-grid {
  display: grid;
  gap: $spacing-4; // 16px
  grid-template-columns: 1fr;
  padding: $spacing-2;
  
  // Tablet: 2 columns
  @include respond-to(md) {
    grid-template-columns: repeat(2, 1fr);
    gap: $spacing-5; // 24px
    padding: $spacing-3;
  }
  
  // Desktop: auto-fill with min 320px
  @include respond-to(lg) {
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  }
}

/* ============================================
   Workflow Card Structure
   ============================================ */

.workflow-card {
  background: var(--color-background);
  border-radius: $border-radius-lg; // 12px
  box-shadow: $shadow-2;
  overflow: hidden;
  transition: transform $transition-base, box-shadow $transition-base;
  border: 1px solid var(--color-outline-dimmest);
  position: relative;
  
  &:hover {
    transform: translateY(-4px);
    box-shadow: $shadow-3;
  }
  
  // Swipeable wrapper (for touch interactions)
  &__swipeable {
    position: relative;
    transition: transform 0.3s ease-out;
    background: var(--color-background);
    
    &.is-swiped {
      transform: translateX(-80px);
      
      @include rtl {
        transform: translateX(80px);
      }
    }
  }
  
  // Hidden action buttons (revealed on swipe)
  &__actions {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    width: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: $spacing-1;
    background: var(--color-accent-primary);
    opacity: 0;
    transition: opacity 0.3s;
    
    @include rtl {
      right: auto;
      left: 0;
    }
    
    .workflow-card.is-swiped & {
      opacity: 1;
    }
    
    // Action button
    .action-btn {
      width: 40px;
      height: 40px;
      min-width: 40px;
      min-height: 40px;
      border: none;
      background: var(--color-background);
      color: var(--color-foreground);
      border-radius: $border-radius-full;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      transition: all $transition-fast;
      
      &:hover {
        transform: scale(1.1);
        background: var(--color-background-higher);
      }
      
      &:active {
        transform: scale(0.95);
      }
      
      &:focus-visible {
        outline: 2px solid var(--color-accent-primary);
        outline-offset: 2px;
      }
    }
  }
}

/* ============================================
   Card Header
   ============================================ */

.workflow-card-header {
  padding: $spacing-4;
  background: linear-gradient(135deg, 
    var(--color-background-higher) 0%, 
    var(--color-background-highest) 100%);
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--color-outline-dimmest);
  
  // Mobile: reduce padding
  @media (max-width: 576px) {
    padding: $spacing-3;
  }
}

.workflow-icon {
  width: 40px;
  height: 40px;
  border-radius: $border-radius-full;
  background: var(--color-background);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  color: var(--color-accent-primary);
  box-shadow: $shadow-1;
  flex-shrink: 0;
  
  // Mobile: smaller icon
  @media (max-width: 576px) {
    width: 36px;
    height: 36px;
    font-size: 18px;
  }
}

.workflow-status {
  font-size: $font-size-xs; // 11px
  padding: 6px 12px;
  border-radius: $border-radius-full;
  font-weight: $font-weight-semibold;
  text-transform: none;
  white-space: nowrap;
  
  // Mobile: smaller padding
  @media (max-width: 576px) {
    font-size: 10px;
    padding: 4px 10px;
  }
  
  // Status colors
  &.status-completed {
    background: var(--color-success-subtle);
    color: var(--color-success);
  }
  
  &.status-running {
    background: var(--color-info-subtle);
    color: var(--color-info);
    animation: pulse 2s infinite;
  }
  
  &.status-failed {
    background: var(--color-error-subtle);
    color: var(--color-error);
  }
  
  &.status-pending {
    background: var(--color-warning-subtle);
    color: var(--color-warning);
  }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

/* ============================================
   Card Body
   ============================================ */

.workflow-card-body {
  padding: $spacing-5;
  
  // Mobile: reduce padding
  @media (max-width: 576px) {
    padding: $spacing-4;
  }
}

.workflow-title {
  font-size: $font-size-lg; // 18px
  font-weight: $font-weight-bold;
  color: var(--color-foreground);
  margin: 0 0 $spacing-4 0;
  line-height: $line-height-tight;
  
  // Mobile: smaller title
  @media (max-width: 576px) {
    font-size: $font-size-base; // 16px
    margin-bottom: $spacing-3;
  }
}

.workflow-info {
  display: flex;
  flex-direction: column;
  gap: $spacing-2;
}

.info-item {
  display: flex;
  align-items: center;
  gap: $spacing-2;
  font-size: $font-size-sm; // 14px
  color: var(--color-foreground-dimmer);
  
  // Mobile: smaller text
  @media (max-width: 576px) {
    font-size: $font-size-xs; // 13px
    gap: $spacing-1;
  }
  
  i {
    color: var(--color-accent-primary);
    font-size: 16px;
    width: 20px;
    flex-shrink: 0;
    
    @media (max-width: 576px) {
      font-size: 14px;
      width: 18px;
    }
  }
  
  &.workflow-id {
    font-family: 'Courier New', monospace;
    font-size: $font-size-xs;
    color: var(--color-foreground-dimmest);
    
    @media (max-width: 576px) {
      font-size: 11px;
    }
  }
}

/* ============================================
   Card Footer
   ============================================ */

.workflow-card-footer {
  padding: $spacing-3 $spacing-5;
  background: var(--color-background-higher);
  border-top: 1px solid var(--color-outline-dimmest);
  
  // Mobile: reduce padding
  @media (max-width: 576px) {
    padding: $spacing-2 $spacing-4;
  }
}

.btn-view-details {
  width: 100%;
  min-height: 48px; // WCAG 2.1 AA touch target
  padding: $spacing-2;
  background: var(--color-background);
  border: 1px solid var(--color-accent-primary);
  color: var(--color-accent-primary);
  border-radius: $border-radius-base;
  cursor: pointer;
  font-size: $font-size-sm;
  font-weight: $font-weight-medium;
  transition: all $transition-base;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: $spacing-2;
  
  &:hover {
    background: var(--color-accent-primary);
    color: var(--color-background);
  }
  
  &:active {
    transform: scale(0.98);
  }
  
  &:focus-visible {
    outline: 2px solid var(--color-accent-primary);
    outline-offset: 2px;
  }
  
  // Mobile: slightly smaller
  @media (max-width: 576px) {
    font-size: $font-size-xs;
    min-height: 44px;
  }
}

/* ============================================
   Empty State
   ============================================ */

.empty-state {
  text-align: center;
  padding: $spacing-10 $spacing-5;
  color: var(--color-foreground-dimmest);
  
  i {
    font-size: 64px;
    color: var(--color-outline-dimmest);
    margin-bottom: $spacing-5;
    
    @media (max-width: 576px) {
      font-size: 48px;
    }
  }
  
  h4 {
    color: var(--color-foreground-dimmer);
    margin-bottom: $spacing-2;
    font-size: $font-size-lg;
    
    @media (max-width: 576px) {
      font-size: $font-size-base;
    }
  }
  
  p {
    color: var(--color-foreground-dimmest);
    font-size: $font-size-sm;
    
    @media (max-width: 576px) {
      font-size: $font-size-xs;
    }
  }
}

/* ============================================
   RTL Support
   ============================================ */

[dir="rtl"] {
  .workflow-card__swipeable.is-swiped {
    transform: translateX(80px);
  }
  
  .workflow-card__actions {
    right: auto;
    left: 0;
  }
}

/* ============================================
   Accessibility Enhancements
   ============================================ */

// Screen reader only text
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

// Reduce motion for users who prefer it
@media (prefers-reduced-motion: reduce) {
  .workflow-card,
  .workflow-card__swipeable,
  .workflow-card__actions,
  .btn-view-details,
  .action-btn {
    transition: none;
    animation: none;
  }
}
